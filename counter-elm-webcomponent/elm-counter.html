<link rel="import" href="../bower_components/polymer/polymer.html" />

<dom-module id="elm-counter" initial-count$="{{initialCount}}">
    <template>
        <div id="embed" ></div>
    </template>

    <script>
        (function() {
            var app;

            Polymer({
                is: "elm-counter",
                properties: {
                    count: {
                        type: Number,
                        count: 0,
                        notify: true,
                        reflectToAttribute: true
                    },

                    initialCount: {
                        type: Number,
                        //reflectToAttribute: true
                    }
                },
                reset() {
                    console.log("reset : called")
                    this.count = 0;
                    app.ports.set.send(this.count);
                },
                created() {
                    console.log("created : called")
                    console.log("created : initial-count = " + this.initialCount)
                },
                ready() {
                    console.log("ready : called")
                    console.log("ready : count = " + this.count)
                    console.log("ready : initial-count = " + this.initialCount)

                },
                attached() {
                    console.log("attached : called")
                    console.log("attached : initial-count = " + this.initialCount)

                    if (this.initialCount) {
                      this.count = this.initialCount;
                    }

                    app = Elm.Component.embed(this.$.embed, {
                        count: this.count
                    });

                    app.ports.setCount.subscribe(count => {
                        this.count = count;
                    });
                }
            });
        })();
    </script>
</dom-module>
